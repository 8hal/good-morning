---
description: Flutter 개발 시 빌드 에러, 샌드박스 실패, 패키지 충돌을 방지하는 필수 워크플로우
alwaysApply: true
---

# Flutter 개발 워크플로우 규칙

## 1. Shell 명령 권한

Flutter/Firebase/Gradle 관련 Shell 명령은 **항상** `required_permissions: ["all"]` 사용.
권한 없이 실행 → 실패 → 재실행의 2회 낭비를 원천 차단한다.

해당 명령 패턴:
- `flutter *` (build, run, analyze, pub, doctor)
- `firebase *` (deploy, init, emulators)
- `dart *` (pub, analyze, run)
- `gradle *`, Android SDK 관련

## 2. 빌드 전 환경 점검

빌드(`flutter build`, `flutter run`) 실행 전 **반드시** 확인:

```bash
# 1단계: 환경 상태 확인
flutter doctor -v

# 2단계: 의존성 정합성 확인
flutter pub get
```

- `flutter doctor` 결과에서 ✗ 표시된 플랫폼으로 빌드 시도 금지
- 사용 가능한 타겟만 제안할 것 (예: Chrome ✓, Android ✗ → Chrome만 제안)

## 3. 패키지 추가 시 사전 검증

새 패키지 추가 시 순서:

```bash
# 1. 추가
flutter pub add [패키지명]

# 2. 즉시 의존성 충돌 확인
flutter pub get

# 3. 충돌 발생 시 → 기존 패키지 버전 확인 후 호환 버전 명시
flutter pub deps | grep [관련패키지]
```

- `pub get`이 실패하면 코드 작성 진행 금지
- 버전 충돌 시 기존 패키지 업그레이드 범위를 사전에 파악

## 4. 코드 변경 → 즉시 검증

파일 1~2개 수정 후 **반드시**:

```bash
flutter analyze
```

- 여러 파일을 한꺼번에 작성 후 한 번에 검증하지 않는다
- analyze 에러 0건 확인 후 다음 파일 작업 진행
- 최종 작업 완료 시 `flutter build web` 까지 확인

## 5. Firebase/외부 서비스 설정

코드로 해결할 수 없는 외부 설정이 필요한 경우:
- **코드 작성 전에** 사용자에게 설정 완료 요청
- 설정 완료 확인 후 코드 작업 시작
- Firebase API 활성화, 인덱스 배포, API 키 발급 등이 해당

## 6. 배포 프로세스

```bash
# 웹 배포 (검증된 순서)
flutter analyze && flutter build web --release && firebase deploy --only hosting
```

- 3개 명령을 `&&`로 연결하여 앞 단계 실패 시 자동 중단
- 배포 후 URL 공유
